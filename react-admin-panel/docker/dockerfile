# syntax=docker/dockerfile:1.7-labs
FROM node:18-alpine

ARG VITE_API_BASE_URL
ARG VITE_API_WEBSOCKET_URL
ARG VITE_TRAEFIK_PANEL_URL
ARG VITE_GUACAMOLE_PANEL_URL

ENV VITE_API_BASE_URL=$VITE_API_BASE_URL
ENV VITE_API_WEBSOCKET_URL=$VITE_API_WEBSOCKET_URL
ENV VITE_TRAEFIK_PANEL_URL=$VITE_TRAEFIK_PANEL_URL
ENV VITE_GUACAMOLE_PANEL_URL=$VITE_GUACAMOLE_PANEL_URL

WORKDIR /app
COPY ./package.json /app/package.json
RUN npm install
RUN npm i -g serve
COPY --exclude=./package.json --exclude=./docker ./ /app
RUN npm run build
EXPOSE 3000
CMD [ "serve", "-l", "3000", "-s", "dist" ]