http:
  routers:
    cvmm-traefik-router:
      rule: Host(`{{ printf "traefik.%s" (env "DOMAIN_NAME") }}`) && (PathPrefix(`/api`) || PathPrefix(`/dashboard`))
      service: api@internal
      entryPoints: web
      middlewares: auth
    cvmm-guacamole-guacamole-router:
      rule: Host(`{{ env "DOMAIN_NAME" }}`) && PathPrefix(`/guacamole`)
      service: cvmm-guacamole-guacamole-service
      entryPoints: web
    cherry-api-router:
      rule: Host(`{{ env "DOMAIN_NAME" }}`) && PathPrefix(`/api`)
      service: cherry-api-service
      entryPoints: web
      middlewares: strip-api-prefix
    cherry-admin-panel-router:
      rule: Host(`{{ env "DOMAIN_NAME" }}`)
      service: cherry-admin-panel-service
      entryPoints: web

  middlewares:
      auth:
        basicAuth:
          users:
            - "CherryAdmin:$apr1$XAa8WkbY$XNs1zQjPVs.8lGKFuSYQV."
      strip-api-prefix:
        stripPrefix: 
          prefixes:
            - "/api"

  services:
    cvmm-guacamole-guacamole-service:
      loadBalancer:
        servers:
          - url: "http://cvmm-guacamole-guacamole:8080/guacamole"
    cherry-api-service:
      loadBalancer:
        servers:
          - url: "http://cherry-api:8000"
    cherry-admin-panel-service:
      loadBalancer:
        servers:
          - url: "http://cherry-admin-panel:3000"